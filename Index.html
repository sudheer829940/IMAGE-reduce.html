ratio = Math.min(w/imgEl.width, h/imgEl.height);
    const iw=imgEl.width*ratio; const ih=imgEl.height*ratio;
    const x=(w-iw)/2; const y=(h-ih)/2;
    if(i>0) pdf.addPage();
    pdf.addImage(imgEl,'JPEG',x,y,iw,ih,undefined,'FAST');
  }
  pdf.save(outName.value||'images.pdf');
}
function loadImage(url,rotation){
  return new Promise((res,rej)=>{
    const img=new Image(); img.onload=()=>{
      if(rotation%360===0){ res(img); return; }
      const c=document.createElement('canvas'); const ctx=c.getContext('2d');
      if(rotation%180!==0){ c.width=img.height; c.height=img.width; } else { c.width=img.width; c.height=img.height; }
      ctx.translate(c.width/2,c.height/2); ctx.rotate(rotation*Math.PI/180); ctx.drawImage(img,-img.width/2,-img.height/2);
      const rimg=new Image(); rimg.onload=()=>res(rimg); rimg.src=c.toDataURL('image/png');
    }; img.onerror=rej; img.src=url;
  });
}
createBtn.addEventListener('click',makePDF);
</script>
</body>

</html>
